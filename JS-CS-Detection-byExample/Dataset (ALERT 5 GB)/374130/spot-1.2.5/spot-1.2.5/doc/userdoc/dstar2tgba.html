<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title><code>dstar2tgba</code></title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="<code>dstar2tgba</code>"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2014-08-21T17:43+0200"/>
<meta name="author" content="Alexandre Duret-Lutz"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="syntax.css" />
<link rel="stylesheet" type="text/css" href="http://spot.lip6.fr/css/spot-zenburn.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js">
/**
 *
 * @source: http://orgmode.org/mathjax/MathJax.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in http://orgmode.org/mathjax/MathJax.js.
 *
 * Copyright (C) 2012-2013  MathJax
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in http://orgmode.org/mathjax/MathJax.js.
 *
 */

/*
@licstart  The following is the entire license notice for the
JavaScript code below.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code below is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code below.
*/
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:center;white-space:nowrap;">
 <a accesskey="h" href="tools.html">UP</a> | <a accesskey="H" href="tools.html">HOME</a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title"><code>dstar2tgba</code></h1>

<p>This tool converts deterministic Rabin and Streett automata, presented
in <a href="http://www.ltl2dstar.de/docs/ltl2dstar.html">the format output by <code>ltl2dstar</code></a>, into Büchi automata.
</p>
<p>
It's usage is almost similar to <a href="ltl2tgba.html"><code>ltl2tgba</code></a> except that instead of
supplying a formula to translate, you should specify a filename
containing the deterministic Rabin or Streett automaton to convert.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Two quick examples</a>
<ul>
<li><a href="#sec-1-1">From Rabin to Büchi</a></li>
<li><a href="#streett_to_tgba_example">Streett to TGBA</a></li>
</ul>
</li>
<li><a href="#sec-2">Details</a>
<ul>
<li><a href="#sec-2-1">General behavior</a></li>
<li><a href="#sec-2-2">Controlling output</a></li>
<li><a href="#sec-2-3">Conversion from Rabin and Streett to TGBA</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Two quick examples</h2>
<div class="outline-text-2" id="text-1">


<p>
Here are some brief examples before we discuss the behavior of
<code>dstar2tgba</code> in more detail.
</p>

</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">From Rabin to Büchi</h3>
<div class="outline-text-3" id="text-1-1">


<p>
The following command instructs <code>ltl2dstar</code> to:
</p><ol>
<li>run <code>ltl2tgba -sD</code> to build a Büchi automaton for <code>Fa &amp; GFb</code>, and then
</li>
<li>convert that Büchi automaton into a deterministic Rabin automaton
   (DRA) stored in <code>fagfb</code>.
</li>
</ol>

<p>Additionally we use <code>ltlfilt</code> to convert our formula to the
prefix format used by <code>ltl2dstar</code>.
</p>



<pre class="src src-sh">ltlfilt -f <span class="org-string">'Fa &amp; GFb'</span> -l | ltl2dstar --ltl2nba=spin:../../src/bin/ltl2tgba@-sD - fagfb
</pre>


<p>
By looking at the file <code>fagfb</code> you can see the <code>ltl2dsar</code> actually
produced a 3-state DRA:
</p>



<pre class="src src-sh">cat fagfb
</pre>


<pre class="example">DRA v2 explicit
Comment: "Safra[NBA=3]"
States: 3
Acceptance-Pairs: 1
Start: 1
AP: 2 "a" "b"
---
State: 0
Acc-Sig: +0
2
2
0
0
State: 1
Acc-Sig:
1
0
1
0
State: 2
Acc-Sig:
2
2
0
0
</pre>


<p>
<code>dstar2tgba</code> can now be used to convert this DRA into a TGBA, a BA, or
a Monitor, using the same options as <a href="ltl2tgba.html"><code>ltl2tgba</code></a>.
</p>
<p>
For instance here is the conversion to a Büchi automaton (<code>-B</code>) in <a href="http://http://www.graphviz.org/">GraphViz</a>'s format:
</p>



<pre class="src src-sh">dstar2tgba -B fagfb
</pre>


<pre class="example">digraph G {
  0 [label="", style=invis, height=0]
  0 -&gt; 1
  1 [label="0"]
  1 -&gt; 2 [label="a\n"]
  1 -&gt; 1 [label="!a\n"]
  2 [label="1", peripheries=2]
  2 -&gt; 2 [label="b\n{Acc[1]}"]
  2 -&gt; 3 [label="!b\n{Acc[1]}"]
  3 [label="2"]
  3 -&gt; 2 [label="b\n"]
  3 -&gt; 3 [label="!b\n"]
}
</pre>


<p>
Which can be rendered as:
</p>


<p>
<img src="fagfb2ba.png"  alt="fagfb2ba.png" />
</p>
<p>
But we could as well require the output to be output as a never claim for Spin (option <code>-s</code>):
</p>



<pre class="src src-sh">dstar2tgba -s fagfb
</pre>


<pre class="example">never {
T0_init:
  if
  :: ((a)) -&gt; goto accept_S2
  :: ((!(a))) -&gt; goto T0_init
  fi;
accept_S2:
  if
  :: ((b)) -&gt; goto accept_S2
  :: ((!(b))) -&gt; goto T0_S3
  fi;
T0_S3:
  if
  :: ((b)) -&gt; goto accept_S2
  :: ((!(b))) -&gt; goto T0_S3
  fi;
}
</pre>


</div>

</div>

<div id="outline-container-streett_to_tgba_example" class="outline-3">
<h3 id="streett_to_tgba_example"><a name="sec-1-2" id="sec-1-2"></a>Streett to TGBA</h3>
<div class="outline-text-3" id="text-streett_to_tgba_example">


<p>
Here is the translation of <code>GFa &amp; GFb</code> to a 4-state Streett automaton:
</p>



<pre class="src src-sh">ltlfilt -f <span class="org-string">'GFa &amp; GFb'</span> -l | ltl2dstar --automata=streett --ltl2nba=spin:../../src/bin/ltl2tgba@-sD - gfagfb
cat gfagfb
</pre>


<pre class="example">DSA v2 explicit
Comment: "Streett{Union{Safra[NBA=2],Safra[NBA=2]}}"
States: 4
Acceptance-Pairs: 2
Start: 0
AP: 2 "a" "b"
---
State: 0
Acc-Sig: -0 -1
3
2
1
0
State: 1
Acc-Sig: +0 -1
3
2
1
0
State: 2
Acc-Sig: -0 +1
3
2
1
0
State: 3
Acc-Sig: +0 +1
3
2
1
0
</pre>


<p>
And now its conversion by <code>dstar2tgba</code> to a 2-state Büchi automaton.
We don't pass any option to <code>dstar2tgba</code> because converting to TGBA in
GraphViz's format is the default:
</p>



<pre class="src src-sh">dstar2tgba gfagfb
</pre>



<p>
<img src="gfagfb2ba.png"  alt="gfagfb2ba.png" />
</p>
<p>
(Obviously the resulting automaton could be simplified further, by
starting with the second state right away.)
</p>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">Details</h2>
<div class="outline-text-2" id="text-2">



</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1">General behavior</h3>
<div class="outline-text-3" id="text-2-1">


<p>
The <code>dstar2tgba</code> tool implement a 4-step process:
</p>
<ol>
<li>read the DRA/DSA
</li>
<li>convert it into TGBA
</li>
<li>postprocess the resulting TGBA (simplifying the automaton, a degeneralizing it into a BA or Monitor if requested)
</li>
<li>output the resulting automaton
</li>
</ol>


</div>

</div>

<div id="outline-container-2-2" class="outline-3">
<h3 id="sec-2-2">Controlling output</h3>
<div class="outline-text-3" id="text-2-2">


<p>
The last two steps are shared with <code>ltl2tgba</code> and use the same options.
</p>
<p>
The type of automaton to produce can be selected using the <code>-B</code> or <code>-M</code>
switches:
</p>

<pre class="example">
  -B, --ba                   Büchi Automaton
  -M, --monitor              Monitor (accepts all finite prefixes of the given
                             formula)
      --tgba                 Transition-based Generalized Büchi Automaton
                             (default)
</pre>


<p>
And these may be refined by a translation intent, should the
post-processor routine had a choice to make:
</p>
<pre class="example">
  -a, --any                  no preference
  -C, --complete             output a complete automaton (combine with other
                             intents)
  -D, --deterministic        prefer deterministic automata
      --small                prefer small automata (default)
</pre>


<p>
The effort put into post-processing can be limited with the <code>--low</code> or
<code>--medium</code> options:
</p>

<pre class="example">
      --high                 all available optimizations (slow, default)
      --low                  minimal optimizations (fast)
      --medium               moderate optimizations
</pre>


<p>
For instance using <code>-a --low</code> will skip any optional post-processing,
should you find <code>dstar2tgba</code> too slow.
</p>
<p>
Finally, the output format can be changed with the following options:
</p>



<pre class="example">-8, --utf8                 enable UTF-8 characters in output (ignored with
                           --lbtt or --spin)
    --dot                  GraphViz's format (default)
-H, --hoaf[=s|t|m|l]       Output the automaton in HOA format.  Add letters
                           to select (s) state-based acceptance, (t)
                           transition-based acceptance, (m) mixed acceptance,
                           (l) single-line output
    --lbtt[=t]             LBTT's format (add =t to force transition-based
                           acceptance even on Büchi automata)
-s, --spin                 Spin neverclaim (implies --ba)
    --spot                 SPOT's format
    --stats=FORMAT         output statistics about the automaton
</pre>


<p>
The <code>--stats</code> options can output statistics about the input and the
output automaton, so it can be useful to search for particular
pattern.
</p>

<p>
For instance here is a complex command that will
</p>
<ol>
<li>generate an infinite stream of random LTL formulas with <a href="randltl.html"><code>randltl</code></a>,
</li>
<li>use <a href="ltlfilt.html"><code>ltlfilt</code></a> to rewrite the W and M operators away (<code>--remove-wm</code>),
   simplify the formulas (<code>-r</code>), remove duplicates (<code>u</code>) as well as
   formulas that have a size less then 3 (<code>--size-min=3</code>),
</li>
<li>use <code>head</code> to keep only 10 of such formula
</li>
<li>loop to process each of these formula:
<ul>
<li>print it
</li>
<li>then convert the formula into <code>ltl2dstar</code>'s input format, process
     it with <code>ltl2dstar</code> (using <code>ltl2tgba</code> as the actual LTL-&gt;BA
     transltor), and process the result with <code>dstar2tgba</code> to build a
     Büchi automaton (<code>-B</code>), favoring determinism if we can (<code>-D</code>),
     and finally displaying some statistics about this conversion.
</li>
</ul>

</li>
</ol>


<p>
The statistics displayed in this case are: <code>%S</code>, the number of states
of the input (Rabin) automaton, <code>%s</code>, the number of states of the
output (Büchi) automaton, <code>%d</code>, whether the output automaton is
deterministic, and <code>%p</code> whether the automaton is complete.
</p>



<pre class="src src-sh">randltl -n -1 --tree-size=10..15 a b c |
ltlfilt --remove-wm -r -u --size-min=3 |
head -n 10 |
<span class="org-keyword">while </span><span class="org-builtin">read</span> f; <span class="org-keyword">do</span>
  <span class="org-builtin">echo</span> <span class="org-string">"$f"</span>
  ltlfilt -l -f <span class="org-string">"$f"</span> |
  ltl2dstar --ltl2nba=spin:../../src/bin/ltl2tgba@-sD - - |
  dstar2tgba -B --stats=<span class="org-string">'  DRA: %Sst.; BA: %sst.; det.? %d; complete? %p'</span>
<span class="org-keyword">done</span>
</pre>



<pre class="example">G((!a &amp; c &amp; F!c) | (a &amp; (!c | Gc)))
  DRA: 6st.; BA: 3st.; det.? 1; complete? 0
G!c R (G!c | (!a &amp; XGa) | (a &amp; XF!a))
  DRA: 7st.; BA: 4st.; det.? 1; complete? 0
G!c | G(a | c)
  DRA: 5st.; BA: 3st.; det.? 1; complete? 0
XGa
  DRA: 3st.; BA: 2st.; det.? 1; complete? 0
!b | ((Xb R (!a | Fb | Xb)) U (!c &amp; (Xb R (!a | Fb | Xb))))
  DRA: 8st.; BA: 6st.; det.? 1; complete? 1
G((b &amp; X!c) | (!b &amp; Xc))
  DRA: 4st.; BA: 3st.; det.? 1; complete? 0
XX!b
  DRA: 5st.; BA: 4st.; det.? 1; complete? 0
GFb
  DRA: 3st.; BA: 3st.; det.? 1; complete? 1
F(G!a R (!b | G!a))
  DRA: 10st.; BA: 10st.; det.? 0; complete? 0
F!c R F!a
  DRA: 8st.; BA: 5st.; det.? 1; complete? 1
</pre>


<p>
An important point you should be aware of when comparing these numbers
of states is that the deterministic automata produced by <code>ltl2dstar</code>
are complete, while the automata produced by <code>dstar2tgba</code>
(deterministic or not) are not complete by default.  This can explain
a difference of one state (the so called "sink" state).
</p>
<p>
You can instruct <code>dstar2tgba</code> to output a complete automaton using the
<code>--complete</code> option (or <code>-C</code> for short).
</p>
</div>

</div>

<div id="outline-container-2-3" class="outline-3">
<h3 id="sec-2-3">Conversion from Rabin and Streett to TGBA</h3>
<div class="outline-text-3" id="text-2-3">


<p>
The algorithms used to convert Rabin and Streett into TGBA/BA are different.
</p>
<ul>
<li id="sec-2-3-1">Rabin to BA<br/>

<p>
The conversion implemented is a variation of Krishnan et al.'s
"Deterministic ω-Automata vis-a-vis Deterministic Büchi Automata"
(ISAAC'94) paper.  They explain how to convert a deterministic Rabin
automaton (DRA) into a deterministic Büchi automaton (DBA) when such
an automaton exist.  The surprising result is that when a DRA is
DBA-realizable, a DBA can be obtained from the DRA without changing
its transition structure.
</p>
<p>
Spot implements a slight refinement to the above technique: any DRA
will be converted into a BA, and the determinism will be conserved
only in strongly connected components where determinism can be
conserved.
</p>
</li>
</ul>
<ul>
<li id="sec-2-3-2">Streett to TGBA<br/>

<p>
Streett automata are converted into non-deterministic TGBA.
When a Streett automaton uses multiple acceptance pairs, we use
generalized acceptance conditions in the TGBA to limit the combinatorial
explosion.
</p>
<p>
A straightforward translation from Streett to BA, as described for
instance by <a href="http://www.automata.rwth-aachen.de/~loeding/diploma_loeding.pdf">Löding's diploma thesis</a>, will create a BA with
\(|Q|\cdot(4^n-3^n+2)\) states if the input Streett automaton has \(|Q|\)
states and \(n\) acceptance pairs.  Our translation to TGBA limits this
to \(|Q|\cdot(2^n+1)\) states.
</p>
<p>
Sometimes, as in the <a href="#streett_to_tgba_example">example for <code>GFa &amp; GFb</code></a> the output of this
conversion will happen to be deterministic.  Let's say that this is
luck: Spot does not implement any algorithm to preserve the
determinism of Streett automata.
</p></li>
</ul>
</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2014-08-21T17:43+0200</p>
<p class="author">Author: Alexandre Duret-Lutz</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.3f with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
