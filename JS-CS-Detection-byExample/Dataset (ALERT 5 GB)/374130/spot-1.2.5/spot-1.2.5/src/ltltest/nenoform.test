#! /bin/sh
# Copyright (C) 2009, 2010, 2011 Laboratoire de Recherche et Développement
# de l'Epita (LRDE).
# Copyright (C) 2003, 2004 Laboratoire d'Informatique de Paris 6 (LIP6),
# département Systèmes Répartis Coopératifs (SRC), Université Pierre
# et Marie Curie.
#
# This file is part of Spot, a model checking library.
#
# Spot is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# Spot is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.


# Check for the negative_normal_form visitor

. ./defs || exit 1

set -e

# A few things that do not change
run 0 ../nenoform 'a' 'a'
run 0 ../nenoform '1' '1'
run 0 ../nenoform '0' '0'
run 0 ../nenoform '!a' '!a'
run 0 ../nenoform 'a U b' 'a U b'
run 0 ../nenoform 'a & b' 'a & b'
run 0 ../nenoform 'a & b' 'b & a'
run 0 ../nenoform 'a & !b & c' 'c & a & !b'
run 0 ../nenoform 'a & b & c' 'b & c & a'
run 0 ../nenoform 'Xa & b & Xa' 'b & Xa & b'
run 0 ../nenoform 'a & b' 'b & a & b'
run 0 ../nenoform 'a & !b' '!b & a & a'
run 0 ../nenoform 'a & b & (Xc |(f U !g)| e)' \
                  'b & a & a & (Xc | e |(f U !g)| e | Xc) & b'
run 0 ../nenoform 'GFa => FGb' 'FG!a || FGb'

# Basic rewritings
run 0 ../nenoform '!!a' 'a'
run 0 ../nenoform '!!!!!a' '!a'
run 0 ../nenoform '!Xa' 'X!a'
run 0 ../nenoform '!Fa' 'G!a'
run 0 ../nenoform '!Ga' 'F!a'
run 0 ../nenoform '!(a ^ b)' '!a&!b | a&b'
run 0 ../nenoform '!(a <=> b)' '(!a&b) | a&!b'
run 0 ../nenoform '!(a => b)' 'a&!b'
run 0 ../nenoform '!(!a => !b)' '!a&b'
run 0 ../nenoform '!(a U b)' '!a R !b'
run 0 ../nenoform '!(a R b)' '!a U !b'
run 0 ../nenoform '!(!a R !b)' 'a U b'
run 0 ../nenoform '!(a & b & c & d & b)' '!a | !b | !c | !d'
run 0 ../nenoform '!(a | b | c | d)' '!a & !b & !c & !d'

# Nested rewritings
run 0 ../nenoform '!(a U (!b U ((a & b & c) R d)))' \
                  '!a R (b R ((!a | !b | !c) U !d))'
run 0 ../nenoform '!(GF a => FG b)' 'GFa & GF!b'

# Rational operators
run 0 ../nenoform '!X{a;b}<>->Fx' 'X{a;b}[]->G!x'
run 0 ../nenoform '!F({a*}<>->{b*}<>->c)' 'G({a*}[]->{b*}[]->!c)'
