--- ../src_base/minecraft_server/net/minecraft/src/ItemDye.java	0000-00-00 00:00:00.000000000 -0000
+++ ../src_work/minecraft_server/net/minecraft/src/ItemDye.java	0000-00-00 00:00:00.000000000 -0000
@@ -2,6 +2,8 @@
 
 import java.util.Random;
 
+import net.minecraft.src.forge.ForgeHooks;
+
 public class ItemDye extends Item
 {
     public static final String dyeColorNames[] =
@@ -30,13 +32,21 @@
 
     public boolean onItemUse(ItemStack itemstack, EntityPlayer entityplayer, World world, int i, int j, int k, int l)
     {
-        if (!entityplayer.canPlayerEdit(i, j, k))
+        if (entityplayer != null && !entityplayer.canPlayerEdit(i, j, k))
         {
             return false;
         }
         if (itemstack.getItemDamage() == 15)
-        {
+        {   
             int i1 = world.getBlockId(i, j, k);
+            if (ForgeHooks.onUseBonemeal(world, i1, i, j, k))
+            {
+                if (!world.isRemote)
+                {
+                    itemstack.stackSize--;
+                }
+                return true;
+            }            
             if (i1 == Block.sapling.blockID)
             {
                 if (!world.isRemote)
@@ -103,14 +113,7 @@
                             world.setBlockAndMetadataWithNotify(k1, l1, i2, Block.tallGrass.blockID, 1);
                             continue;
                         }
-                        if (itemRand.nextInt(3) != 0)
-                        {
-                            world.setBlockWithNotify(k1, l1, i2, Block.plantYellow.blockID);
-                        }
-                        else
-                        {
-                            world.setBlockWithNotify(k1, l1, i2, Block.plantRed.blockID);
-                        }
+                        ForgeHooks.plantGrassPlant(world, k1, l1, i2);
                     }
                 }
                 return true;
