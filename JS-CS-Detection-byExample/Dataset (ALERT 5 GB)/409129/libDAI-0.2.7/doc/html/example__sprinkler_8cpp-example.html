<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libDAI: example_sprinkler.cpp</title>
<link href="customdoxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>example_sprinkler.cpp</h1>This example illustrates how to manually construct a factor graph and write it to a file.<p>
<div class="fragment"><pre class="fragment"><span class="comment">/*  This file is part of libDAI - http://www.libdai.org/</span>
<span class="comment"> *</span>
<span class="comment"> *  libDAI is licensed under the terms of the GNU General Public License version</span>
<span class="comment"> *  2, or (at your option) any later version. libDAI is distributed without any</span>
<span class="comment"> *  warranty. See the file COPYING for more details.</span>
<span class="comment"> *</span>
<span class="comment"> *  Copyright (C) 2008-2010  Joris Mooij  [joris dot mooij at libdai dot org]</span>
<span class="comment"> */</span>


<span class="preprocessor">#include &lt;<a class="code" href="factorgraph_8h.html" title="Defines the FactorGraph class, which represents factor graphs (e.g., Bayesian networks...">dai/factorgraph.h</a>&gt;</span>
<span class="preprocessor">#include &lt;iostream&gt;</span>
<span class="preprocessor">#include &lt;fstream&gt;</span>

<span class="keyword">using namespace </span>std;
<span class="keyword">using namespace </span>dai;

<span class="keywordtype">int</span> main() {
    <span class="comment">// This example program illustrates how to construct a factorgraph</span>
    <span class="comment">// by means of the sprinkler network example discussed at</span>
    <span class="comment">// http://www.cs.ubc.ca/~murphyk/Bayes/bnintro.html</span>

    <a name="_a0"></a><a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> C(0, 2);  <span class="comment">// Define binary variable Cloudy (with label 0)</span>
    <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> S(1, 2);  <span class="comment">// Define binary variable Sprinkler (with label 1)</span>
    <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> R(2, 2);  <span class="comment">// Define binary variable Rain (with label 2)</span>
    <a class="code" href="classdai_1_1Var.html" title="Represents a discrete random variable.">Var</a> W(3, 2);  <span class="comment">// Define binary variable Wetgrass (with label 3)</span>

    <span class="comment">// Define probability distribution for C</span>
    <a name="a1"></a><a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with values of type dai::Real.">Factor</a> P_C( C );
    P_C.set(0, 0.5);   <span class="comment">// C = 0</span>
    P_C.set(1, 0.5);   <span class="comment">// C = 1</span>

    <span class="comment">// Define conditional probability of S given C</span>
    <a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with values of type dai::Real.">Factor</a> P_S_given_C( <a name="_a2"></a><a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>( S, C ) );
    P_S_given_C.set(0, 0.5);   <span class="comment">// C = 0, S = 0</span>
    P_S_given_C.set(1, 0.9);   <span class="comment">// C = 1, S = 0</span>
    P_S_given_C.set(2, 0.5);   <span class="comment">// C = 0, S = 1</span>
    P_S_given_C.set(3, 0.1);   <span class="comment">// C = 1, S = 1</span>

    <span class="comment">// Define conditional probability of R given C</span>
    <a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with values of type dai::Real.">Factor</a> P_R_given_C( <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>( R, C ) );
    P_R_given_C.set(0, 0.8);   <span class="comment">// C = 0, R = 0</span>
    P_R_given_C.set(1, 0.2);   <span class="comment">// C = 1, R = 0</span>
    P_R_given_C.set(2, 0.2);   <span class="comment">// C = 0, R = 1</span>
    P_R_given_C.set(3, 0.8);   <span class="comment">// C = 1, R = 1</span>

    <span class="comment">// Define conditional probability of W given S and R</span>
    <a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with values of type dai::Real.">Factor</a> P_W_given_S_R( <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>( S, R ) | W );
    P_W_given_S_R.set(0, 1.0);  <span class="comment">// S = 0, R = 0, W = 0</span>
    P_W_given_S_R.set(1, 0.1);  <span class="comment">// S = 1, R = 0, W = 0</span>
    P_W_given_S_R.set(2, 0.1);  <span class="comment">// S = 0, R = 1, W = 0</span>
    P_W_given_S_R.set(3, 0.01); <span class="comment">// S = 1, R = 1, W = 0</span>
    P_W_given_S_R.set(4, 0.0);  <span class="comment">// S = 0, R = 0, W = 1</span>
    P_W_given_S_R.set(5, 0.9);  <span class="comment">// S = 1, R = 0, W = 1</span>
    P_W_given_S_R.set(6, 0.9);  <span class="comment">// S = 0, R = 1, W = 1</span>
    P_W_given_S_R.set(7, 0.99); <span class="comment">// S = 1, R = 1, W = 1</span>

    <span class="comment">// Build factor graph consisting of those four factors</span>
    vector&lt;Factor&gt; SprinklerFactors;
    SprinklerFactors.push_back( P_C );
    SprinklerFactors.push_back( P_R_given_C );
    SprinklerFactors.push_back( P_S_given_C );
    SprinklerFactors.push_back( P_W_given_S_R );
    <a name="_a3"></a><a class="code" href="classdai_1_1FactorGraph.html" title="Represents a factor graph.">FactorGraph</a> SprinklerNetwork( SprinklerFactors );

    <span class="comment">// Write factorgraph to a file</span>
    SprinklerNetwork.<a name="a4"></a><a class="code" href="classdai_1_1FactorGraph.html#5d574f5c52f67cb24971650562588f2e" title="Writes a factor graph to a file.">WriteToFile</a>( <span class="stringliteral">"sprinkler.fg"</span> );
    cout &lt;&lt; <span class="stringliteral">"Sprinkler network written to sprinkler.fg"</span> &lt;&lt; endl;

    <span class="comment">// Output some information about the factorgraph</span>
    cout &lt;&lt; SprinklerNetwork.<a name="a5"></a><a class="code" href="classdai_1_1FactorGraph.html#107d707b4ef22d83f19c40989c227d5d" title="Returns number of variables.">nrVars</a>() &lt;&lt; <span class="stringliteral">" variables"</span> &lt;&lt; endl;
    cout &lt;&lt; SprinklerNetwork.<a name="a6"></a><a class="code" href="classdai_1_1FactorGraph.html#de52f40e90ae438c985f9568811654a9" title="Returns number of factors.">nrFactors</a>() &lt;&lt; <span class="stringliteral">" factors"</span> &lt;&lt; endl;

    <span class="comment">// Calculate joint probability of all four variables</span>
    <a class="code" href="namespacedai.html#7515abf9952cd312e95a34ada0670e85" title="Represents a factor with values of type dai::Real.">Factor</a> P;
    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> I = 0; I &lt; SprinklerNetwork.<a class="code" href="classdai_1_1FactorGraph.html#de52f40e90ae438c985f9568811654a9" title="Returns number of factors.">nrFactors</a>(); I++ )
        P *= SprinklerNetwork.<a name="a7"></a><a class="code" href="classdai_1_1FactorGraph.html#9a930964b0d006bb0d6ace88fb1da481" title="Returns constant reference to I &amp;#39;th factor.">factor</a>( I );
    <span class="comment">// P.normalize();  // Not necessary: a Bayesian network is already normalized by definition</span>

    <span class="comment">// Calculate some probabilities</span>
    <a name="a8"></a><a class="code" href="namespacedai.html#e7d0472fdc89a8635825d01940e91cbf" title="Real number (alias for double, which could be changed to long double if necessary)...">Real</a> denom = P.marginal( W )[1];
    cout &lt;&lt; <span class="stringliteral">"P(W=1) = "</span> &lt;&lt; denom &lt;&lt; endl;
    cout &lt;&lt; <span class="stringliteral">"P(S=1 | W=1) = "</span> &lt;&lt; P.marginal( <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>( S, W ) )[3] / denom &lt;&lt; endl;
    cout &lt;&lt; <span class="stringliteral">"P(R=1 | W=1) = "</span> &lt;&lt; P.marginal( <a class="code" href="classdai_1_1VarSet.html" title="Represents a set of variables.">VarSet</a>( R, W ) )[3] / denom &lt;&lt; endl;

    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Aug 19 13:58:09 2010 for libDAI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
